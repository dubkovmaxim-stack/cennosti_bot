"""
üéØ –ë–û–¢ –î–õ–Ø –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –¶–ï–ù–ù–û–°–¢–ï–ô - –ü–ï–†–ï–†–ê–ë–û–¢–ê–ù–ù–ê–Ø –í–ï–†–°–ò–Ø
‚Ä¢ –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞: 40√ó1 –∏–∑ 5 ‚Üí 10√ó1 –∏–∑ 4
‚Ä¢ –ì–ª—É–±–æ–∫–∏–π –ò–ò-–∞–Ω–∞–ª–∏–∑ —Å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–æ–π
‚Ä¢ –ö–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
‚Ä¢ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
"""

import json
import random
import asyncio
import logging
import sys
import aiohttp
from datetime import datetime
from typing import Dict, List, Optional, Set, Tuple
import os

# –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫
try:
    from aiogram import Bot, Dispatcher, types, F
    from aiogram.filters import Command
    from aiogram.types import (
        ReplyKeyboardMarkup, 
        KeyboardButton, 
        ReplyKeyboardRemove,
        InlineKeyboardMarkup,
        InlineKeyboardButton
    )
    from aiogram.enums import ParseMode
    from aiogram.client.default import DefaultBotProperties
    from aiogram.fsm.context import FSMContext
    from aiogram.fsm.state import State, StatesGroup
    from aiogram.fsm.storage.memory import MemoryStorage
except ImportError:
    print("‚ùå –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install aiogram aiohttp")
    input("–ù–∞–∂–º–∏—Ç–µ Enter...")
    sys.exit(1)

# ========== –ù–ê–°–¢–†–û–ô–ö–ò ==========
BOT_TOKEN = "8414114962:AAHDuiIPohDnF9PDgvlLu3IOomDksMhWPXk"

# –ò–ò API (–∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞)
USE_AI_API = False  # –ü–æ–º–µ–Ω—è–π—Ç–µ –Ω–∞ True –µ—Å–ª–∏ –µ—Å—Ç—å API –∫–ª—é—á
AI_API_KEY = ""
AI_API_URL = "https://api.openai.com/v1/chat/completions"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# ========== –ó–ê–ì–†–£–ó–ö–ê –¶–ï–ù–ù–û–°–¢–ï–ô ==========
try:
    with open('values.json', 'r', encoding='utf-8') as f:
        VALUES_DATA = json.load(f)
    
    if isinstance(VALUES_DATA, dict) and "values" in VALUES_DATA:
        ALL_VALUES = VALUES_DATA["values"]
    elif isinstance(VALUES_DATA, list):
        ALL_VALUES = VALUES_DATA
    else:
        ALL_VALUES = []
    
    print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(ALL_VALUES)} —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π")
    VALUE_BY_ID = {v["id"]: v for v in ALL_VALUES}
    
    # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    CATEGORIES = {}
    for value in ALL_VALUES:
        cat = value.get('category', '–†–∞–∑–Ω–æ–µ')
        if cat not in CATEGORIES:
            CATEGORIES[cat] = []
        CATEGORIES[cat].append(value)
    
    print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ {len(CATEGORIES)} –∫–∞—Ç–µ–≥–æ—Ä–∏–π")
    
except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ values.json: {e}")
    ALL_VALUES = []
    VALUE_BY_ID = {}
    CATEGORIES = {}

# ========== –°–û–°–¢–û–Ø–ù–ò–Ø FSM ==========
class GameStates(StatesGroup):
    waiting_start = State()
    stage1_round = State()
    stage2_round = State()
    asking_goals = State()
    generating_analysis = State()
    showing_analysis = State()

# ========== –ë–ê–ó–ê –ü–°–ò–•–û–õ–û–ì–ò–ß–ï–°–ö–ò–• –®–ê–ë–õ–û–ù–û–í ==========
PSYCHOLOGICAL_PROFILES = {
    '–±–∞–ª–∞–Ω—Å': {
        'strengths': [
            "–ì–∞—Ä–º–æ–Ω–∏—á–Ω–æ–µ —Å–æ—á–µ—Ç–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∏ –≤–Ω–µ—à–Ω–µ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ - –≤—ã —É–º–µ–µ—Ç–µ –Ω–∞—Ö–æ–¥–∏—Ç—å –∑–æ–ª–æ—Ç—É—é —Å–µ—Ä–µ–¥–∏–Ω—É –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Å—Ñ–µ—Ä–∞–º–∏ –∂–∏–∑–Ω–∏, —á—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—á–Ω—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è.",
            "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–∏–≥–µ–Ω—Ç - —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ä–æ–≤–Ω–æ–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ —Å—Ç—Ä–µ—Å—Å–æ–≤—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö –≥–æ–≤–æ—Ä–∏—Ç –æ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ —Å–∞–º–æ—Ä–µ–≥—É–ª—è—Ü–∏–∏ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Å–∏—Ö–∏–∫–∏.",
            "–°–∏—Å—Ç–µ–º–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ - –≤–∞—à–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–º–µ–Ω–∏–µ –≤–∏–¥–µ—Ç—å –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –∞—Å–ø–µ–∫—Ç–∞–º–∏ –∂–∏–∑–Ω–∏ –∏ –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É –±—ã—Ç–∏—è."
        ],
        'energy_distribution': {
            'personal': "–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–∏—Ä (40%) - —Ä–∞–∑–≤–∏—Ç–∞—è —Ä–µ—Ñ–ª–µ–∫—Å–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–π –∫—É—Ä—Å, —Å–æ—Ö—Ä–∞–Ω—è—è –∞—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å.",
            'social': "–û—Ç–Ω–æ—à–µ–Ω–∏—è (35%) - –≥–ª—É–±–∏–Ω–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–≤—è–∑–µ–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ —á—É–≤—Å—Ç–≤–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∑–Ω–∞—á–∏–º—ã–º –≥—Ä—É–ø–ø–∞–º.",
            'practical': "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (25%) - —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω—ã–º –∞—Å–ø–µ–∫—Ç–∞–º —Å–æ–∑–¥–∞–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –±–µ–∑ –ø–µ—Ä–µ–∫–æ—Å–∞ –≤ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–º."
        }
    },
    '–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è': {
        'strengths': [
            "–¶–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª–µ–Ω–Ω–æ—Å—Ç—å –∏ —Ñ–æ–∫—É—Å - –Ω–µ–π—Ä–æ–ø—Å–∏—Ö–æ–ª–æ–≥–∏ –æ—Ç–º–µ—á–∞—é—Ç, —á—Ç–æ —Ç–∞–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å —Ä–∞–∑–≤–∏—Ç–æ–π –ø—Ä–µ—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–π –∫–æ—Ä–æ–π, –æ—Ç–≤–µ—á–∞—é—â–µ–π –∑–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å.",
            "–†–µ–∑–∏–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å (–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å) - —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—Ç—å –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –º–æ—Ç–∏–≤–∞—Ü–∏–∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞.",
            "–ê–≥–µ–Ω—Ç–∏–≤–Ω–æ—Å—Ç—å (—á—É–≤—Å—Ç–≤–æ –∞–≤—Ç–æ—Ä—Å—Ç–≤–∞ –∂–∏–∑–Ω–∏) - —è—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É–±–µ–∂–¥–µ–Ω–∏–µ, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—Å–∏–ª–∏–π, –∞ –Ω–µ –≤–Ω–µ—à–Ω–∏—Ö –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤."
        ],
        'energy_distribution': {
            'achievement': "–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–µ–π (50%) - –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Ñ–æ–∫—É—Å –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —Å–æ–∑–¥–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–æ—Ñ–∞–º–∏–Ω–∞ –æ—Ç –º–∞–ª–µ–Ω—å–∫–∏—Ö –ø–æ–±–µ–¥, —Ñ–æ—Ä–º–∏—Ä—É—è –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π reinforcing loop.",
            'development': "–†–∞–∑–≤–∏—Ç–∏–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π (30%) - –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ —Å–∞–º–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã, —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç—å —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞.",
            'recognition': "–ü—Ä–∏–∑–Ω–∞–Ω–∏–µ (20%) - –∑–¥–æ—Ä–æ–≤–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ —É—Å–ø–µ—Ö–æ–≤ —Å–ª—É–∂–∏—Ç –≤–Ω–µ—à–Ω–∏–º –º–∞—Ä–∫–µ—Ä–æ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏."
        }
    },
    '–æ—Ç–Ω–æ—à–µ–Ω–∏—è': {
        'strengths': [
            "–≠–º–ø–∞—Ç–∏—è –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç - —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ç–æ—á–Ω–æ —Å—á–∏—Ç—ã–≤–∞—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥—Ä—É–≥–∏—Ö –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º —Ñ–∞–∫—Ç–æ—Ä–æ–º —É—Å–ø–µ—à–Ω—ã—Ö –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π.",
            "–ü—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ç–∏–ø–∞ - –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É—é—â–∏–π—Å—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –±–ª–∏–∑–∫–∏–µ —Å–≤—è–∑–∏ –±–µ–∑ —Ç—Ä–µ–≤–æ–≥–∏ –æ–± –æ—Ç–≤–µ—Ä–∂–µ–Ω–∏–∏ –∏–ª–∏ –ø–æ–≥–ª–æ—â–µ–Ω–∏–∏.",
            "–ö–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω–∞—è –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å - –≤–ª–∞–¥–µ–Ω–∏–µ –≤–µ—Ä–±–∞–ª—å–Ω—ã–º–∏ –∏ –Ω–µ–≤–µ—Ä–±–∞–ª—å–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –ø–æ–∑–≤–æ–ª—è—é—â–µ–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —è—Å–Ω—ã–µ –∏ –≥–ª—É–±–æ–∫–∏–µ –º–µ–∂–ª–∏—á–Ω–æ—Å—Ç–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã."
        ],
        'energy_distribution': {
            'intimacy': "–ì–ª—É–±–∏–Ω–∞ —Å–≤—è–∑–µ–π (45%) - –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–π —Å–æ–∑–¥–∞—é—Ç ¬´—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –±–∞–Ω–∫–æ–≤—Å–∫–∏–π —Å—á–µ—Ç¬ª —Å –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π —Å—Ç–∞–≤–∫–æ–π –≤–∑–∞–∏–º–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏.",
            'community': "–°–æ–æ–±—â–µ—Å—Ç–≤–æ (35%) - —á—É–≤—Å—Ç–≤–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∑–Ω–∞—á–∏–º—ã–º —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º –≥—Ä—É–ø–ø–∞–º —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç –±–∞–∑–æ–≤—É—é –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏.",
            'care': "–ó–∞–±–æ—Ç–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (20%) - –ø—Ä–æ—Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º—É –æ–∫—Å–∏—Ç–æ—Ü–∏–Ω–∞, —Å–Ω–∏–∂–∞—è —Å—Ç—Ä–µ—Å—Å –∏ —É–≤–µ–ª–∏—á–∏–≤–∞—è —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–µ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏–µ."
        }
    },
    '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ': {
        'strengths': [
            "–î–∏–≤–µ—Ä–≥–µ–Ω—Ç–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ - —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∏–¥–µ–π, —á—Ç–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –≤—ã—Å–æ–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –ø—Ä–∞–≤–æ–≥–æ –ø–æ–ª—É—à–∞—Ä–∏—è –∏ default mode network –º–æ–∑–≥–∞.",
            "–¢–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ - –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Å–∏—Ç—É–∞—Ü–∏—è—Ö –±–µ–∑ —á–µ—Ç–∫–∏—Ö –ø—Ä–∞–≤–∏–ª –∏ –≥–æ—Ç–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π.",
            "–≠—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å - —Ä–∞–∑–≤–∏—Ç–æ–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ –∫—Ä–∞—Å–æ—Ç—ã –∏ –≥–∞—Ä–º–æ–Ω–∏–∏, –ø–æ–∑–≤–æ–ª—è—é—â–µ–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ —Ü–µ–Ω–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ —Ñ–æ—Ä–º—ã."
        ],
        'energy_distribution': {
            'exploration': "–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ (40%) - –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –Ω–æ–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º—É –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è –º–æ–∑–≥–∞, —Å–æ–∑–¥–∞–≤–∞—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –º–æ—Ç–∏–≤–∞—Ü–∏—é –∫ –ø–æ–∑–Ω–∞–Ω–∏—é.",
            'expression': "–°–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏–µ (35%) - —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –º–∏—Ä–∞ –≤–æ–≤–Ω–µ —Å–ª—É–∂–∏—Ç –º–µ—Ö–∞–Ω–∏–∑–º–æ–º —Å–∞–º–æ–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ä–µ–≥—É–ª—è—Ü–∏–∏.",
            'innovation': "–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ (25%) - –ø—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç –Ω–µ–π—Ä–æ–ø–ª–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—É—é –º–æ–ª–æ–¥–æ—Å—Ç—å –º–æ–∑–≥–∞."
        }
    }
}

# –î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
VALUE_DEVELOPMENT_GUIDES = {
    '–û–ø—Ç–∏–º–∏–∑–º': {
        'why': "–û–ø—Ç–∏–º–∏–∑–º - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ, –∞ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —á–µ–ª–æ–≤–µ–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∫–∞–∫ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ, —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∏ –≤–Ω–µ—à–Ω–∏–µ. –ù–µ–π—Ä–æ–ø–ª–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω.",
        'how': [
            "–í–µ–¥–∏—Ç–µ ¬´–¥–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ—Ö –±–ª–∞–≥¬ª - –µ–∂–µ–≤–µ—á–µ—Ä–Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ 3 —Ö–æ—Ä–æ—à–∏–µ —Å–æ–±—ã—Ç–∏—è –¥–Ω—è –∏ –∏—Ö –ø—Ä–∏—á–∏–Ω—ã. –≠—Ç–æ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ñ–æ–∫—É—Å –≤–Ω–∏–º–∞–Ω–∏—è —Å —É–≥—Ä–æ–∑ –Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.",
            "–ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ ¬´–∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—É—é –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫—É¬ª - –ø—Ä–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –º—ã—Å–ª—è—Ö –∑–∞–¥–∞–≤–∞–π—Ç–µ—Å—å –≤–æ–ø—Ä–æ—Å–æ–º: ¬´–ö–∞–∫–∏–µ –µ—Å—Ç—å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ? –ö–∞–∫–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è?¬ª",
            "–°–æ–∑–¥–∞–π—Ç–µ ¬´–±–∏–±–ª–∏–æ—Ç–µ–∫—É —É—Å–ø–µ—Ö–æ–≤¬ª - —Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –∫–∞–∫–∏–º–∏ –±—ã –º–∞–ª—ã–º–∏ –æ–Ω–∏ –Ω–∏ –±—ã–ª–∏. –†–µ–≥—É–ª—è—Ä–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —É–∫—Ä–µ–ø–ª—è–µ—Ç –≤–µ—Ä—É –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∏–ª—ã."
        ],
        'result': "–ß–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø–æ–≤—ã—Å–∏—Ç—Å—è —É—Ä–æ–≤–µ–Ω—å —Å–µ—Ä–æ—Ç–æ–Ω–∏–Ω–∞, —Å–Ω–∏–∑–∏—Ç—Å—è –∫–æ—Ä—Ç–∏–∑–æ–ª, —É–ª—É—á—à–∏—Ç—Å—è –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –∑–∞ —Å—á–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è perceptual field."
    },
    '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º': {
        'why': "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä–∞–∑–≤–∏—Ç–∏—é —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ deliberate practice (—Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ) –∏ –º–µ—Ç–∞–ø–æ–∑–Ω–∞–Ω–∏–∏ (–æ—Å–æ–∑–Ω–∞–Ω–∏–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º—ã—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤).",
        'how': [
            "–í–Ω–µ–¥—Ä–∏—Ç–µ —Ç–µ—Ö–Ω–∏–∫—É ¬´—Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞¬ª - –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –≤–∞–∂–Ω–æ–π –∑–∞–¥–∞—á–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ: —á—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, —á—Ç–æ –Ω–µ—Ç, –∫–∞–∫–∏–µ —É—Ä–æ–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω—ã. –≠—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç learning curve.",
            "–°–æ–∑–¥–∞–π—Ç–µ ¬´–º–∞—Ç—Ä–∏—Ü—É –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π¬ª - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ 3 –∫–ª—é—á–µ–≤—ã—Ö –Ω–∞–≤—ã–∫–∞ –≤ –≤–∞—à–µ–π –æ–±–ª–∞—Å—Ç–∏ –∏ —Ä–∞–∑–±–µ–π—Ç–µ –∏—Ö –Ω–∞ –º–∏–∫—Ä–æ-–Ω–∞–≤—ã–∫–∏. –†–∞–±–æ—Ç–∞–π—Ç–µ –Ω–∞–¥ –æ–¥–Ω–∏–º –º–∏–∫—Ä–æ-–Ω–∞–≤—ã–∫–æ–º –≤ –Ω–µ–¥–µ–ª—é.",
            "–ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ ¬´–æ–±—É—á–µ–Ω–∏–µ —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º¬ª - –≤–º–µ—Å—Ç–æ –º–∞—Ä–∞—Ñ–æ–Ω—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π, –∑–∞–Ω–∏–º–∞–π—Ç–µ—Å—å –ø–æ 25-45 –º–∏–Ω—É—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —É–ª—É—á—à–∞–µ—Ç –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—é –ø–∞–º—è—Ç–∏ –Ω–∞ 40%."
        ],
        'result': "–ß–µ—Ä–µ–∑ 6 –º–µ—Å—è—Ü–µ–≤ —Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è ¬´—ç–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –∏–Ω—Ç—É–∏—Ü–∏—è¬ª - —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è."
    },
    '–ù–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å': {
        'why': "–ù–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (grit) - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å—Ç—Ä–∞—Å—Ç–∏ –∏ —É–ø–æ—Ä—Å—Ç–≤–∞ –≤ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Ü–µ–ª–µ–π. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ê–Ω–∂–µ–ª—ã –î–∞–∫–≤–æ—Ä—Ç –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ grit –ª—É—á—à–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ø–µ—Ö, —á–µ–º IQ –∏–ª–∏ —Ç–∞–ª–∞–Ω—Ç.",
        'how': [
            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Ö–Ω–∏–∫—É ¬´—Ü–µ–ª—å-—Å–∏—Å—Ç–µ–º–∞-–ø—Ä–∏–≤—ã—á–∫–∞¬ª - –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç–µ —Ü–µ–ª—å –≤ —Å–∏—Å—Ç–µ–º—É –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π, –∞ –¥–µ–π—Å—Ç–≤–∏—è - –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ —á–µ—Ä–µ–∑ 21-–¥–Ω–µ–≤–Ω—ã–µ —Ü–∏–∫–ª—ã.",
            "–ü—Ä–∏–º–µ–Ω—è–π—Ç–µ ¬´—Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ —É–ø—Ä—è–º—Å—Ç–≤–æ¬ª - –±—É–¥—å—Ç–µ –≥–∏–±–∫–∏–º–∏ –≤ –º–µ—Ç–æ–¥–∞—Ö, –Ω–æ –Ω–µ–ø–æ–∫–æ–ª–µ–±–∏–º—ã–º–∏ –≤ –Ω–∞–º–µ—Ä–µ–Ω–∏—è—Ö. –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ —Ç–∞–∫—Ç–∏–∫—É, —Å–æ—Ö—Ä–∞–Ω—è—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—é.",
            "–°–æ–∑–¥–∞–π—Ç–µ ¬´—Ü–µ–ø–æ—á–∫—É –Ω–µ—Ä–∞–∑—Ä—ã–≤–Ω–æ—Å—Ç–∏¬ª - –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ç—Ä–µ–∫–µ—Ä –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞. –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç ¬´–Ω–µ —Ä–∞–∑—Ä—ã–≤–∞—Ç—å —Ü–µ–ø—å¬ª —Å–æ–∑–¥–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –º–æ—Ç–∏–≤–∞—Ü–∏—é."
        ],
        'result': "–†–∞–∑–æ–≤—å–µ—Ç—Å—è ¬´–∞–Ω—Ç–∏—Ö—Ä—É–ø–∫–æ—Å—Ç—å¬ª - —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –Ω–µ –ø—Ä–æ—Å—Ç–æ –≤—ã–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å—Ç—Ä–µ—Å—Å, –Ω–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è —Å–∏–ª—å–Ω–µ–µ –±–ª–∞–≥–æ–¥–∞—Ä—è –≤—ã–∑–æ–≤–∞–º. –£–≤–µ–ª–∏—á–∏—Ç—Å—è —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å –∫ —Ñ—Ä—É—Å—Ç—Ä–∞—Ü–∏–∏."
    },
    '–ß—É—Ç–∫–æ—Å—Ç—å': {
        'why': "–ß—É—Ç–∫–æ—Å—Ç—å (attunement) - —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ç–æ—á–Ω–æ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞—Ç—å –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥—Ä—É–≥–∏—Ö. –≠—Ç–æ –æ—Å–Ω–æ–≤–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π.",
        'how': [
            "–ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ ¬´–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–ª—É—à–∞–Ω–∏–µ –±–µ–∑ —Ä–µ—à–µ–Ω–∏—è¬ª - —Å–ª—É—à–∞–π—Ç–µ, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∞ –Ω–µ –æ—Ç–≤–µ—Ç–∏—Ç—å. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Ö–Ω–∏–∫—É mirroring: –æ—Ç—Ä–∞–∂–∞–π—Ç–µ —Å–ª–æ–≤–∞ –∏ —ç–º–æ—Ü–∏–∏ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞.",
            "–†–∞–∑–≤–∏–≤–∞–π—Ç–µ ¬´—Ç–µ–æ—Ä–∏—é –ø—Å–∏—Ö–∏—á–µ—Å–∫–æ–≥–æ¬ª (theory of mind) - —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∑–∞–¥–∞–≤–∞–π—Ç–µ—Å—å –≤–æ–ø—Ä–æ—Å–æ–º: ¬´–ß—Ç–æ —Å–µ–π—á–∞—Å —á—É–≤—Å—Ç–≤—É–µ—Ç —ç—Ç–æ—Ç —á–µ–ª–æ–≤–µ–∫? –ö–∞–∫–∏–µ —É –Ω–µ–≥–æ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏?¬ª",
            "–¢—Ä–µ–Ω–∏—Ä—É–π—Ç–µ ¬´–Ω–µ–≤–µ—Ä–±–∞–ª—å–Ω—É—é —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å¬ª - –æ–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –º–∏–∫—Ä–æ–≤—ã—Ä–∞–∂–µ–Ω–∏—è (1/25 —Å–µ–∫—É–Ω–¥—ã), —Ç–æ–Ω –≥–æ–ª–æ—Å–∞, –ø–æ–∑—É. –≠—Ç–æ –∫–ª—é—á –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é –∏—Å—Ç–∏–Ω–Ω—ã—Ö —ç–º–æ—Ü–∏–π."
        ],
        'result': "–£–ª—É—á—à–∏—Ç—Å—è –∫–∞—á–µ—Å—Ç–≤–æ –≤—Å–µ—Ö —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, —Å–Ω–∏–∑–∏—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤, –≤–æ–∑—Ä–∞—Å—Ç–µ—Ç —É—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –∏ —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞."
    }
}

# ========== –ö–õ–ê–°–° –ò–ì–†–´ –° –ù–û–í–û–ô –ú–ï–•–ê–ù–ò–ö–û–ô ==========
class ValueGame:
    def __init__(self, user_id: int, username: str):
        self.user_id = user_id
        self.username = username
        
        # –í—Å–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ (200+)
        self.all_values = ALL_VALUES.copy()
        random.shuffle(self.all_values)
        
        # –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞: 40 —Ä–∞—É–Ω–¥–æ–≤ √ó 1 –∏–∑ 5 ‚Üí 10 —Ä–∞—É–Ω–¥–æ–≤ √ó 1 –∏–∑ 4
        self.stage = 1
        self.round = 0
        self.total_rounds_stage1 = 40
        self.total_rounds_stage2 = 10
        
        # –í—ã–±—Ä–∞–Ω–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏
        self.stage1_selected: List[Dict] = []  # 40 –∏–∑ 200
        self.stage2_selected: List[Dict] = []  # 10 –∏–∑ 40
        
        # –¢–µ–∫—É—â–∞—è –≥—Ä—É–ø–ø–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞
        self.current_group: List[Dict] = []
        self.current_options_count = 0
        
        # –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
        self.used_ids: Set[int] = set()
        self.available_values = self.all_values.copy()
        
        # –î–ª—è —ç—Ç–∞–ø–∞ 2 - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        self.stage2_by_category = {}
        
        # –¶–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        self.user_goals = ""
        
        # –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
        self.start_time = datetime.now()
        
        # –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å
        self.psychological_profile = None
    
    def get_available_for_stage1(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è —ç—Ç–∞–ø–∞ 1"""
        available = [v for v in self.available_values if v["id"] not in self.used_ids]
        return available
    
    def prepare_stage1_round(self) -> bool:
        """–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–∞—É–Ω–¥–∞ –¥–ª—è —ç—Ç–∞–ø–∞ 1 (–≤—ã–±—Ä–∞—Ç—å 1 –∏–∑ 5)"""
        if len(self.stage1_selected) >= self.total_rounds_stage1:
            return False
        
        available = self.get_available_for_stage1()
        
        if len(available) < 5:
            # –ï—Å–ª–∏ –æ—Å—Ç–∞–ª–æ—Å—å –º–µ–Ω—å—à–µ 5, –∑–∞–≤–µ—Ä—à–∞–µ–º —ç—Ç–∞–ø
            return False
        
        # –í—ã–±–∏—Ä–∞–µ–º 5 —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
        self.current_group = random.sample(available, 5)
        self.current_options_count = 5
        
        # –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–µ (–Ω–æ –µ—â–µ –Ω–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ)
        for value in self.current_group:
            self.used_ids.add(value["id"])
        
        self.round += 1
        return True
    
    def process_stage1_choice(self, choice_index: int) -> bool:
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –Ω–∞ —ç—Ç–∞–ø–µ 1"""
        if not (0 <= choice_index < len(self.current_group)):
            return False
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å
        selected_value = self.current_group[choice_index]
        self.stage1_selected.append(selected_value)
        
        # –£–¥–∞–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
        if selected_value in self.available_values:
            self.available_values.remove(selected_value)
        
        # –û—á–∏—â–∞–µ–º —Ç–µ–∫—É—â—É—é –≥—Ä—É–ø–ø—É
        self.current_group = []
        
        return True
    
    def prepare_stage2_round(self) -> bool:
        """–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–∞—É–Ω–¥–∞ –¥–ª—è —ç—Ç–∞–ø–∞ 2 (–≤—ã–±—Ä–∞—Ç—å 1 –∏–∑ 4 –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º)"""
        if len(self.stage2_selected) >= self.total_rounds_stage2:
            return False
        
        # –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π —Ä–∞—É–Ω–¥ —ç—Ç–∞–ø–∞ 2, –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        if not self.stage2_by_category:
            self._group_stage1_values_by_category()
        
        # –í—ã–±–∏—Ä–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–Ω–∞—á–µ–Ω–∏–π
        available_categories = []
        for cat, values in self.stage2_by_category.items():
            if len(values) >= 2:  # –ù—É–∂–Ω–æ —Ö–æ—Ç—è –±—ã 2 –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
                available_categories.append((cat, values))
        
        if not available_categories:
            # –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å, –∑–∞–≤–µ—Ä—à–∞–µ–º
            return False
        
        # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
        selected_cat, cat_values = random.choice(available_categories)
        
        # –ë–µ—Ä–µ–º 4 —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        sample_size = min(4, len(cat_values))
        self.current_group = random.sample(cat_values, sample_size)
        self.current_options_count = sample_size
        
        # –£–¥–∞–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        for value in self.current_group:
            if value in self.stage2_by_category[selected_cat]:
                self.stage2_by_category[selected_cat].remove(value)
        
        # –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –æ–ø—É—Å—Ç–µ–ª–∞, —É–¥–∞–ª—è–µ–º –µ–µ
        if not self.stage2_by_category[selected_cat]:
            del self.stage2_by_category[selected_cat]
        
        self.round += 1
        return True
    
    def _group_stage1_values_by_category(self):
        """–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —ç—Ç–∞–ø–∞ 1 –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª—è —ç—Ç–∞–ø–∞ 2"""
        for value in self.stage1_selected:
            cat = value.get('category', '–†–∞–∑–Ω–æ–µ')
            if cat not in self.stage2_by_category:
                self.stage2_by_category[cat] = []
            self.stage2_by_category[cat].append(value)
    
    def process_stage2_choice(self, choice_index: int) -> bool:
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –Ω–∞ —ç—Ç–∞–ø–µ 2"""
        if not (0 <= choice_index < len(self.current_group)):
            return False
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å
        selected_value = self.current_group[choice_index]
        self.stage2_selected.append(selected_value)
        
        # –û—á–∏—â–∞–µ–º —Ç–µ–∫—É—â—É—é –≥—Ä—É–ø–ø—É
        self.current_group = []
        
        return True
    
    def get_progress(self) -> Dict:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–≥—Ä—ã"""
        if self.stage == 1:
            current = len(self.stage1_selected)
            target = self.total_rounds_stage1
            stage_text = "–≠—Ç–∞–ø 1: –í—ã–±–æ—Ä 40 –∏–∑ 200"
        else:
            current = len(self.stage2_selected)
            target = self.total_rounds_stage2
            stage_text = "–≠—Ç–∞–ø 2: –§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä 10 –∏–∑ 40"
        
        percent = (current / target * 100) if target > 0 else 0
        
        return {
            "stage": self.stage,
            "stage_text": stage_text,
            "current": current,
            "target": target,
            "percent": round(percent, 1),
            "round": self.round
        }
    
    def is_complete(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ª–∏ –∏–≥—Ä–∞"""
        return (self.stage == 2 and 
                len(self.stage2_selected) >= self.total_rounds_stage2)
    
    def get_final_values(self) -> List[Dict]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ 10 —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π"""
        return self.stage2_selected[:10]
    
    def analyze_psychological_profile(self):
        """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π"""
        # –ê–Ω–∞–ª–∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        categories = {}
        for value in self.stage2_selected:
            cat = value.get('category', '–†–∞–∑–Ω–æ–µ')
            categories[cat] = categories.get(cat, 0) + 1
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π –ø—Ä–æ—Ñ–∏–ª—å
        if not categories:
            self.psychological_profile = '–±–∞–ª–∞–Ω—Å'
            return
        
        # –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
        main_category = max(categories.items(), key=lambda x: x[1])[0]
        
        profile_map = {
            '—Ä–∞–¥–æ—Å—Ç—å': '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ',
            '–º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–µ': '–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è',
            '–º–æ—Ç–∏–≤–∞—Ü–∏—è': '–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è',
            '–Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å': '–±–∞–ª–∞–Ω—Å',
            '—Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ': '–±–∞–ª–∞–Ω—Å',
            '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ': '—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ',
            '—á–µ—Å—Ç–Ω–æ—Å—Ç—å': '–æ—Ç–Ω–æ—à–µ–Ω–∏—è',
            '—Ä–∞–∑–≤–∏—Ç–∏–µ': '–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è',
            '–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞': '–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è',
            '–æ—Ç–Ω–æ—à–µ–Ω–∏—è': '–æ—Ç–Ω–æ—à–µ–Ω–∏—è'
        }
        
        self.psychological_profile = profile_map.get(main_category, '–±–∞–ª–∞–Ω—Å')

# ========== –ë–û–¢ –ò –î–ò–°–ü–ï–¢–ß–ï–† ==========
bot = Bot(token=BOT_TOKEN, default=DefaultBotProperties(parse_mode=ParseMode.HTML))
storage = MemoryStorage()
dp = Dispatcher(storage=storage)

active_games: Dict[int, ValueGame] = {}

# ========== –ö–õ–ê–í–ò–ê–¢–£–†–´ ==========
def get_main_keyboard():
    """–û—Å–Ω–æ–≤–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞"""
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="üéÆ –ù–ê–ß–ê–¢–¨ –¢–ï–°–¢")],
            [KeyboardButton(text="üìä –ü–†–û–ì–†–ï–°–°"), KeyboardButton(text="‚ùì –ü–û–ú–û–©–¨")]
        ],
        resize_keyboard=True,
        one_time_keyboard=False
    )

def get_choice_keyboard_5():
    """–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ 1 –∏–∑ 5"""
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="1Ô∏è‚É£"), KeyboardButton(text="2Ô∏è‚É£"), KeyboardButton(text="3Ô∏è‚É£")],
            [KeyboardButton(text="4Ô∏è‚É£"), KeyboardButton(text="5Ô∏è‚É£")],
            [KeyboardButton(text="‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ä–∞—É–Ω–¥")]
        ],
        resize_keyboard=True,
        one_time_keyboard=True
    )

def get_choice_keyboard_4():
    """–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ 1 –∏–∑ 4"""
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="A"), KeyboardButton(text="B")],
            [KeyboardButton(text="C"), KeyboardButton(text="D")],
            [KeyboardButton(text="‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ä–∞—É–Ω–¥")]
        ],
        resize_keyboard=True,
        one_time_keyboard=True
    )

def get_goals_keyboard():
    """–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ü–µ–ª–µ–π"""
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="üöÄ –ö–∞—Ä—å–µ—Ä–∞ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è")],
            [KeyboardButton(text="üíº –ë–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã")],
            [KeyboardButton(text="üß† –õ–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç")],
            [KeyboardButton(text="‚ù§Ô∏è –û—Ç–Ω–æ—à–µ–Ω–∏—è –∏ —Å–µ–º—å—è")],
            [KeyboardButton(text="‚öñÔ∏è –ë–∞–ª–∞–Ω—Å –∏ –≥–∞—Ä–º–æ–Ω–∏—è")],
            [KeyboardButton(text="üéØ –î—Ä—É–≥–∞—è —Ü–µ–ª—å")]
        ],
        resize_keyboard=True,
        one_time_keyboard=True
    )

# ========== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–û–ú–ê–ù–î ==========
@dp.message(Command("start"))
@dp.message(F.text == "üéÆ –ù–ê–ß–ê–¢–¨ –¢–ï–°–¢")
async def cmd_start(message: types.Message, state: FSMContext):
    """–ù–∞—á–∞–ª–æ –Ω–æ–≤–æ–π –∏–≥—Ä—ã"""
    user_id = message.from_user.id
    
    if not ALL_VALUES:
        await message.answer("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π", reply_markup=get_main_keyboard())
        return
    
    # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É
    game = ValueGame(user_id, message.from_user.full_name or "–ò–≥—Ä–æ–∫")
    active_games[user_id] = game
    
    # –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏
    rules = f"""
üéØ <b>–¢–ï–°–¢ ¬´–ú–û–ò –¶–ï–ù–ù–û–°–¢–ò 2.0¬ª</b>

‚ú® <b>–ù–û–í–ê–Ø –ú–ï–•–ê–ù–ò–ö–ê:</b>

<b>–≠—Ç–∞–ø 1: –®–ò–†–û–ö–ò–ô –í–´–ë–û–†</b>
‚Ä¢ 40 —Ä–∞—É–Ω–¥–æ–≤
‚Ä¢ –í –∫–∞–∂–¥–æ–º —Ä–∞—É–Ω–¥–µ: 5 —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
‚Ä¢ –í—ã–±—Ä–∞—Ç—å: 1 —Å–∞–º—É—é –≤–∞–∂–Ω—É—é
‚Ä¢ –ò—Ç–æ–≥: 40 —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π –∏–∑ 200

<b>–≠—Ç–∞–ø 2: –ì–õ–£–ë–û–ö–ò–ô –û–¢–ë–û–†</b>
‚Ä¢ 10 —Ä–∞—É–Ω–¥–æ–≤  
‚Ä¢ –í –∫–∞–∂–¥–æ–º —Ä–∞—É–Ω–¥–µ: 4 —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∏–∑ –æ–¥–Ω–æ–π —Ç–µ–º–∞—Ç–∏–∫–∏
‚Ä¢ –í—ã–±—Ä–∞—Ç—å: 1 —Å–∞–º—É—é –≤–∞–∂–Ω—É—é
‚Ä¢ –ò—Ç–æ–≥: 10 –≥–ª–∞–≤–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π

üéÅ <b>–ß–¢–û –ü–û–õ–£–ß–ò–¢–ï:</b>
1. –°–ø–∏—Å–æ–∫ 10 –≥–ª–∞–≤–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
2. –ì–ª—É–±–æ–∫–∏–π –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
3. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é
4. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

‚è±Ô∏è <b>–í—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:</b> 10-15 –º–∏–Ω—É—Ç

üöÄ <b>–ù–∞—á–∏–Ω–∞–µ–º 1 —ç—Ç–∞–ø!</b>
"""
    
    await message.answer(rules, reply_markup=ReplyKeyboardRemove())
    await state.set_state(GameStates.stage1_round)
    
    # –ù–∞—á–∏–Ω–∞–µ–º –ø–µ—Ä–≤—ã–π —Ä–∞—É–Ω–¥
    await send_next_round(message, game, state)

async def send_next_round(message: types.Message, game: ValueGame, state: FSMContext):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥"""
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —ç—Ç–∞–ø–∞/–∏–≥—Ä—ã
    if game.stage == 1 and len(game.stage1_selected) >= game.total_rounds_stage1:
        # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —ç—Ç–∞–ø—É 2
        game.stage = 2
        await state.set_state(GameStates.stage2_round)
        await send_stage_transition(message, game, state)
        return
    elif game.is_complete():
        # –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Å–ø—Ä–∞—à–∏–≤–∞–µ–º –æ —Ü–µ–ª—è—Ö
        await ask_about_goals(message, game, state)
        return
    
    progress = game.get_progress()
    
    # –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞—É–Ω–¥
    if game.stage == 1:
        if not game.prepare_stage1_round():
            # –ó–∞–≤–µ—Ä—à–∞–µ–º —ç—Ç–∞–ø 1
            game.stage = 2
            await state.set_state(GameStates.stage2_round)
            await send_stage_transition(message, game, state)
            return
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —ç—Ç–∞–ø–∞ 1
        text = f"""
<b>–≠—Ç–∞–ø 1: –í–´–ë–ï–†–ò–¢–ï 1 –ò–ó 5</b>

üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: {progress['percent']}%
‚úÖ –û—Ç–æ–±—Ä–∞–Ω–æ: {progress['current']}/{progress['target']}

üéØ <b>–ö–∞–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –≤–∞—Å –≤–∞–∂–Ω–µ–µ?</b>
"""
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ü–µ–Ω–Ω–æ—Å—Ç–∏
        for i, value in enumerate(game.current_group, 1):
            text += f"\n{i}Ô∏è‚É£ <b>{value['name']}</b>"
            if value.get('description'):
                text += f"\n<em>{value['description']}</em>"
            text += "\n"
        
        text += "\n–ù–∞–∂–º–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–Ω–æ–ø–∫–∏ (1-5)"
        
        await message.answer(text, reply_markup=get_choice_keyboard_5())
        
    else:  # stage == 2
        if not game.prepare_stage2_round():
            # –ó–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É
            await ask_about_goals(message, game, state)
            return
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —ç—Ç–∞–ø–∞ 2
        text = f"""
<b>–≠—Ç–∞–ø 2: –í–´–ë–ï–†–ò–¢–ï 1 –ò–ó 4</b>

üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: {progress['percent']}%
‚úÖ –û—Ç–æ–±—Ä–∞–Ω–æ: {progress['current']}/{progress['target']}

üéØ <b>–ö–∞–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏?</b>
"""
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ü–µ–Ω–Ω–æ—Å—Ç–∏ —Å –±—É–∫–≤–∞–º–∏
        letters = ['A', 'B', 'C', 'D']
        for i, value in enumerate(game.current_group):
            text += f"\n{letters[i]}. <b>{value['name']}</b>"
            if value.get('description'):
                text += f"\n<em>{value['description']}</em>"
            text += "\n"
        
        text += "\n–ù–∞–∂–º–∏—Ç–µ –±—É–∫–≤—É –∫–Ω–æ–ø–∫–∏ (A-D)"
        
        await message.answer(text, reply_markup=get_choice_keyboard_4())

async def send_stage_transition(message: types.Message, game: ValueGame, state: FSMContext):
    """–°–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–µ—Ä–µ—Ö–æ–¥–µ –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏"""
    
    if game.stage == 2:
        transition_text = f"""
üéâ <b>–≠–¢–ê–ü 1 –ó–ê–í–ï–†–®–ï–ù!</b>

‚úÖ –í—ã –æ—Ç–æ–±—Ä–∞–ª–∏: {len(game.stage1_selected)} —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π –∏–∑ 200

‚û°Ô∏è <b>–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º—É —ç—Ç–∞–ø—É 2</b>

–¢–µ–ø–µ—Ä—å –º—ã –±—É–¥–µ–º –≤—ã–±–∏—Ä–∞—Ç—å –∏–∑ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ —Ç–µ–º–∞—Ç–∏–∫–µ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π.

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–µ –ø—Ä–æ—Å—Ç–æ –≤–∞–∂–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏, –∞ —Ç–µ, —á—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —è–≤–ª—è—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–æ–æ–±—Ä–∞–∑—É—é—â–∏–º–∏ –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏.

–ù–∞–∂–º–∏—Ç–µ /continue —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–±–æ—Ä!
"""
        await message.answer(transition_text, reply_markup=ReplyKeyboardRemove())

@dp.message(Command("continue"))
async def cmd_continue(message: types.Message, state: FSMContext):
    """–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞"""
    user_id = message.from_user.id
    
    if user_id not in active_games:
        await message.answer("üéÆ –°–Ω–∞—á–∞–ª–∞ –Ω–∞—á–Ω–∏—Ç–µ —Ç–µ—Å—Ç", reply_markup=get_main_keyboard())
        return
    
    game = active_games[user_id]
    await send_next_round(message, game, state)

@dp.message(Command("progress"))
@dp.message(F.text == "üìä –ü–†–û–ì–†–ï–°–°")
async def cmd_progress(message: types.Message):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å"""
    user_id = message.from_user.id
    
    if user_id not in active_games:
        await message.answer("üéÆ –°–Ω–∞—á–∞–ª–∞ –Ω–∞—á–Ω–∏—Ç–µ —Ç–µ—Å—Ç", reply_markup=get_main_keyboard())
        return
    
    game = active_games[user_id]
    progress = game.get_progress()
    
    game_time = (datetime.now() - game.start_time).seconds
    mins = game_time // 60
    secs = game_time % 60
    
    stats = f"""
üìä <b>–ü–†–û–ì–†–ï–°–° –¢–ï–°–¢–ê</b>

<b>{progress['stage_text']}</b>
‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: {progress['percent']}%
üéØ –û—Ç–æ–±—Ä–∞–Ω–æ: {progress['current']} –∏–∑ {progress['target']}
üîÑ –†–∞—É–Ω–¥–æ–≤: {progress['round']}
‚è±Ô∏è –í—Ä–µ–º—è: {mins} –º–∏–Ω {secs} —Å–µ–∫
"""
    
    await message.answer(stats, reply_markup=ReplyKeyboardRemove())

@dp.message(Command("help"))
@dp.message(F.text == "‚ùì –ü–û–ú–û–©–¨")
async def cmd_help(message: types.Message):
    """–ü–æ–º–æ—â—å"""
    help_text = """
‚ùì <b>–ü–û–ú–û–©–¨</b>

<b>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</b>
‚Ä¢ –ù–∞–∂–∏–º–∞–π—Ç–µ –∫–Ω–æ–ø–∫–∏ —Å –Ω–æ–º–µ—Ä–∞–º–∏ (1-5) –∏–ª–∏ –±—É–∫–≤–∞–º–∏ (A-D)
‚Ä¢ –í—ã–±–∏—Ä–∞–π—Ç–µ –æ–¥–Ω—É —Ü–µ–Ω–Ω–æ—Å—Ç—å –≤ –∫–∞–∂–¥–æ–º —Ä–∞—É–Ω–¥–µ
‚Ä¢ –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –ø–æ–∫–∞ –Ω–µ –≤—ã–±–µ—Ä–µ—Ç–µ 10 –≥–ª–∞–≤–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π

<b>–≠—Ç–∞–ø—ã:</b>
1. <b>–≠—Ç–∞–ø 1:</b> 40 —Ä–∞—É–Ω–¥–æ–≤ √ó –≤—ã–±—Ä–∞—Ç—å 1 –∏–∑ 5
2. <b>–≠—Ç–∞–ø 2:</b> 10 —Ä–∞—É–Ω–¥–æ–≤ √ó –≤—ã–±—Ä–∞—Ç—å 1 –∏–∑ 4 (–ø–æ —Ç–µ–º–∞—Ç–∏–∫–∞–º)

<b>–ö–Ω–æ–ø–∫–∏:</b>
üéÆ –ù–ê–ß–ê–¢–¨ –¢–ï–°–¢ - –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É
üìä –ü–†–û–ì–†–ï–°–° - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å
‚ùì –ü–û–ú–û–©–¨ - —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞
‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ä–∞—É–Ω–¥ - –µ—Å–ª–∏ —Å–ª–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å

<b>–°–æ–≤–µ—Ç:</b> –û—Ç–≤–µ—á–∞–π—Ç–µ –±—ã—Å—Ç—Ä–æ, –¥–æ–≤–µ—Ä—è—è –ø–µ—Ä–≤–æ–º—É –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—é!
"""
    await message.answer(help_text, reply_markup=get_main_keyboard())

# ========== –û–ë–†–ê–ë–û–¢–ö–ê –í–´–ë–û–†–ê ==========
@dp.message(F.text.in_(["1Ô∏è‚É£", "2Ô∏è‚É£", "3Ô∏è‚É£", "4Ô∏è‚É£", "5Ô∏è‚É£", "1", "2", "3", "4", "5"]))
async def handle_stage1_choice(message: types.Message, state: FSMContext):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –Ω–∞ —ç—Ç–∞–ø–µ 1 (1-5)"""
    user_id = message.from_user.id
    
    if user_id not in active_games:
        await message.answer("üéÆ –°–Ω–∞—á–∞–ª–∞ –Ω–∞—á–Ω–∏—Ç–µ —Ç–µ—Å—Ç", reply_markup=get_main_keyboard())
        return
    
    game = active_games[user_id]
    current_state = await state.get_state()
    
    if current_state != GameStates.stage1_round:
        await message.answer("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —ç—Ç–∞–ø –¥–ª—è —ç—Ç–æ–≥–æ –≤—ã–±–æ—Ä–∞")
        return
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤–≤–æ–¥ –≤ –∏–Ω–¥–µ–∫—Å
    text = message.text.replace("Ô∏è‚É£", "")  # –£–±–∏—Ä–∞–µ–º —ç–º–æ–¥–∑–∏
    try:
        choice_index = int(text) - 1
    except:
        await message.answer("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—ã–±–æ—Ä–∞")
        return
    
    # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
    if not game.process_stage1_choice(choice_index):
        await message.answer("‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–±–æ—Ä–∞")
        return
    
    # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º
    await send_next_round(message, game, state)

@dp.message(F.text.in_(["A", "B", "C", "D", "a", "b", "c", "d"]))
async def handle_stage2_choice(message: types.Message, state: FSMContext):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –Ω–∞ —ç—Ç–∞–ø–µ 2 (A-D)"""
    user_id = message.from_user.id
    
    if user_id not in active_games:
        await message.answer("üéÆ –°–Ω–∞—á–∞–ª–∞ –Ω–∞—á–Ω–∏—Ç–µ —Ç–µ—Å—Ç", reply_markup=get_main_keyboard())
        return
    
    game = active_games[user_id]
    current_state = await state.get_state()
    
    if current_state != GameStates.stage2_round:
        await message.answer("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —ç—Ç–∞–ø –¥–ª—è —ç—Ç–æ–≥–æ –≤—ã–±–æ—Ä–∞")
        return
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤–≤–æ–¥ –≤ –∏–Ω–¥–µ–∫—Å
    text = message.text.upper()
    letter_to_index = {'A': 0, 'B': 1, 'C': 2, 'D': 3}
    
    if text not in letter_to_index:
        await message.answer("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—ã–±–æ—Ä–∞")
        return
    
    choice_index = letter_to_index[text]
    
    # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
    if not game.process_stage2_choice(choice_index):
        await message.answer("‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–±–æ—Ä–∞")
        return
    
    # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º
    await send_next_round(message, game, state)

@dp.message(F.text == "‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ä–∞—É–Ω–¥")
async def handle_skip(message: types.Message, state: FSMContext):
    """–ü—Ä–æ–ø—É—Å–∫ —Ä–∞—É–Ω–¥–∞"""
    user_id = message.from_user.id
    
    if user_id not in active_games:
        return
    
    game = active_games[user_id]
    current_state = await state.get_state()
    
    # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å
    if current_state == GameStates.stage1_round:
        choice_index = random.randint(0, 4)
        game.process_stage1_choice(choice_index)
    elif current_state == GameStates.stage2_round:
        choice_index = random.randint(0, 3)
        game.process_stage2_choice(choice_index)
    
    await message.answer("‚è≠Ô∏è –†–∞—É–Ω–¥ –ø—Ä–æ–ø—É—â–µ–Ω. –°–ª–µ–¥—É—é—â–∏–π –≤—ã–±–æ—Ä...")
    await send_next_round(message, game, state)

# ========== –ó–ê–í–ï–†–®–ï–ù–ò–ï –ò –ê–ù–ê–õ–ò–ó ==========
async def ask_about_goals(message: types.Message, game: ValueGame, state: FSMContext):
    """–°–ø—Ä–∞—à–∏–≤–∞–µ–º –æ —Ü–µ–ª—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    
    # –°–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏
    final_values = game.get_final_values()
    
    result_text = f"""
üéâ <b>–ü–û–ó–î–†–ê–í–õ–Ø–ï–ú, {game.username}!</b>

‚úÖ <b>–¢–ï–°–¢ –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù</b>

üèÜ <b>–í–ê–®–ò 10 –ì–õ–ê–í–ù–´–• –¶–ï–ù–ù–û–°–¢–ï–ô:</b>

"""
    
    for i, value in enumerate(final_values, 1):
        result_text += f"\n{i}. <b>{value['name']}</b>"
        if value.get('description'):
            result_text += f"\n   <em>{value['description']}</em>"
        if value.get('category'):
            result_text += f"\n   üè∑Ô∏è {value['category']}"
        result_text += "\n"
    
    result_text += f"""
üìä <b>–°–¢–ê–¢–ò–°–¢–ò–ö–ê:</b>
‚Ä¢ –ù–∞—á–∞–ª–æ: {len(ALL_VALUES)} —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
‚Ä¢ –≠—Ç–∞–ø 1: –æ—Ç–æ–±—Ä–∞–Ω–æ 40 –∏–∑ 200
‚Ä¢ –≠—Ç–∞–ø 2: –≤—ã–±—Ä–∞–Ω–æ 10 –≥–ª–∞–≤–Ω—ã—Ö
‚Ä¢ –†–∞—É–Ω–¥–æ–≤: {game.round}
‚Ä¢ –í—Ä–µ–º—è: {(datetime.now() - game.start_time).seconds // 60} –º–∏–Ω {(datetime.now() - game.start_time).seconds % 60} —Å–µ–∫

üéØ <b>–î–õ–Ø –¢–û–ß–ù–û–ì–û –ê–ù–ê–õ–ò–ó–ê:</b>
"""
    
    await message.answer(result_text, reply_markup=ReplyKeyboardRemove())
    await asyncio.sleep(2)
    
    # –°–ø—Ä–∞—à–∏–≤–∞–µ–º –æ —Ü–µ–ª—è—Ö
    goals_text = """
üîç <b>–ù–ê –ß–¢–û –í–´ –•–û–¢–ò–¢–ï –ù–ê–ü–†–ê–í–ò–¢–¨ –≠–ù–ï–†–ì–ò–Æ?</b>

–í—ã–±–µ—Ä–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ñ–µ—Ä—É –¥–ª—è —Ñ–æ–∫—É—Å–∞ –≤ –±–ª–∏–∂–∞–π—à–∏–µ 3-6 –º–µ—Å—è—Ü–µ–≤:

<em>–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Å–æ–∑–¥–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, —É—á–∏—Ç—ã–≤–∞—é—â–∏–µ –≤–∞—à–∏ —Ç–µ–∫—É—â–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏.</em>
"""
    
    await message.answer(goals_text, reply_markup=get_goals_keyboard())
    await state.set_state(GameStates.asking_goals)

@dp.message(GameStates.asking_goals)
async def handle_goals_input(message: types.Message, state: FSMContext):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ —Ü–µ–ª–µ–π"""
    user_id = message.from_user.id
    
    if user_id not in active_games:
        await message.answer("üéÆ –°–Ω–∞—á–∞–ª–∞ –Ω–∞—á–Ω–∏—Ç–µ —Ç–µ—Å—Ç", reply_markup=get_main_keyboard())
        return
    
    game = active_games[user_id]
    goals_input = message.text.strip()
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ü–µ–ª–∏
    game.user_goals = goals_input
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏–∑–∞
    await state.set_state(GameStates.generating_analysis)
    await generate_deep_analysis(message, game, state)

async def generate_deep_analysis(message: types.Message, game: ValueGame, state: FSMContext):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑"""
    
    # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å
    game.analyze_psychological_profile()
    final_values = game.get_final_values()
    
    # –°–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ –∞–Ω–∞–ª–∏–∑–∞
    analysis_start = f"""
üîÆ <b>–ù–ê–ß–ò–ù–ê–Æ –ì–õ–£–ë–û–ö–ò–ô –ê–ù–ê–õ–ò–ó</b>

‚è±Ô∏è <em>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞...</em>

‚Ä¢ –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Å–æ—á–µ—Ç–∞–Ω–∏–µ –≤–∞—à–∏—Ö 10 —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
‚Ä¢ –û–ø—Ä–µ–¥–µ–ª—è—é –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å
‚Ä¢ –ì–æ—Ç–æ–≤–ª—é –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
‚Ä¢ –°–æ–∑–¥–∞—é –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –¥–ª—è —Ü–µ–ª–∏: <b>{game.user_goals}</b>

<i>–≠—Ç–æ –∑–∞–π–º–µ—Ç –æ–∫–æ–ª–æ 30 —Å–µ–∫—É–Ω–¥</i>
"""
    
    await message.answer(analysis_start, reply_markup=ReplyKeyboardRemove())
    
    # –ò–º–∏—Ç–∞—Ü–∏—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
    processing_msg = await message.answer("üîÑ <i>–ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω–Ω–æ—Å—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã... 0%</i>")
    
    for percent in range(10, 101, 10):
        await asyncio.sleep(2.5)
        if percent < 40:
            await processing_msg.edit_text(f"üß† <i>–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑... {percent}%</i>")
        elif percent < 70:
            await processing_msg.edit_text(f"üìä <i>–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π... {percent}%</i>")
        else:
            await processing_msg.edit_text(f"‚ú® <i>–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞... {percent}%</i>")
    
    await processing_msg.delete()
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∞–ª–∏–∑
    await show_deep_analysis_report(message, game, state)

async def show_deep_analysis_report(message: types.Message, game: ValueGame, state: FSMContext):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –æ—Ç—á–µ—Ç–∞"""
    
    final_values = game.get_final_values()
    profile = game.psychological_profile
    profile_data = PSYCHOLOGICAL_PROFILES.get(profile, PSYCHOLOGICAL_PROFILES['–±–∞–ª–∞–Ω—Å'])
    
    # –ß–∞—Å—Ç—å 1: –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—Ç—Ä–µ—Ç
    analysis = f"""
üé≠ <b>–í–ê–® –ü–°–ò–•–û–õ–û–ì–ò–ß–ï–°–ö–ò–ô –ü–û–†–¢–†–ï–¢</b>

<em>–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ 10 —Å–∏—Å—Ç–µ–º–æ–æ–±—Ä–∞–∑—É—é—â–∏—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π</em>

‚ú® <b>–î–û–ú–ò–ù–ò–†–£–Æ–©–ò–ô –ü–†–û–§–ò–õ–¨:</b> {profile.upper()}
üìà <b>–£–†–û–í–ï–ù–¨ –û–°–û–ó–ù–ê–ù–ù–û–°–¢–ò:</b> –í—ã—Å–æ–∫–∏–π (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞)
‚ö° <b>–≠–ù–ï–†–ì–ï–¢–ò–ß–ï–°–ö–ò–ô –¢–ò–ü:</b> –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ

"""
    
    # –ß–∞—Å—Ç—å 2: –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã (3 –ø—É–Ω–∫—Ç–∞ —Å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–æ–π)
    analysis += f"""
üåü <b>–°–ò–õ–¨–ù–´–ï –°–¢–û–†–û–ù–´, –ö–û–¢–û–†–´–ï –í–´ –ü–†–û–Ø–í–õ–Ø–ï–¢–ï:</b>

"""
    
    for i, strength in enumerate(profile_data['strengths'][:3], 1):
        analysis += f"\n{i}. {strength}\n"
    
    # –ß–∞—Å—Ç—å 3: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ (3 –ø—É–Ω–∫—Ç–∞ —Å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏)
    analysis += f"""
‚ö° <b>–†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ü–°–ò–•–ò–ß–ï–°–ö–û–ô –≠–ù–ï–†–ì–ò–ò:</b>

"""
    
    energy_items = list(profile_data['energy_distribution'].items())
    for i, (area, explanation) in enumerate(energy_items[:3], 1):
        analysis += f"\n<b>{i}. {area.upper()}</b>\n{explanation}\n"
    
    # –ß–∞—Å—Ç—å 4: –¶–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è (–∫–ª—é—á–µ–≤–æ–π —Ä–∞–∑–¥–µ–ª)
    analysis += f"""
üéØ <b>–¶–ï–ù–ù–û–°–¢–ò –î–õ–Ø –£–°–ò–õ–ï–ù–ò–Ø –ò –†–ê–ó–í–ò–¢–ò–Ø:</b>

"""
    
    # –í—ã–±–∏—Ä–∞–µ–º 3 –∫–ª—é—á–µ–≤—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è
    key_values = final_values[:3]
    for i, value in enumerate(key_values, 1):
        value_name = value['name']
        guide = VALUE_DEVELOPMENT_GUIDES.get(value_name, VALUE_DEVELOPMENT_GUIDES['–û–ø—Ç–∏–º–∏–∑–º'])
        
        analysis += f"\n<b>{i}. {value_name.upper()}</b>\n"
        analysis += f"<em>–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:</em> {guide['why']}\n\n"
        analysis += f"<em>–ö–∞–∫ —Ä–∞–∑–≤–∏–≤–∞—Ç—å:</em>\n"
        
        for j, method in enumerate(guide['how'][:3], 1):
            analysis += f"   {j}. {method}\n"
        
        analysis += f"\n<em>–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</em> {guide['result']}\n\n"
    
    # –ß–∞—Å—Ç—å 5: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ)
    analysis += f"""
‚ö° <b>–ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –î–ï–ô–°–¢–í–ò–Ø –ù–ê –ë–õ–ò–ñ–ê–ô–®–ò–ï 90 –î–ù–ï–ô:</b>

"""
    
    actions = [
        {
            'title': "–°–û–ó–î–ê–ù–ò–ï –¶–ï–ù–ù–û–°–¢–ù–û–ì–û –ö–û–ú–ü–ê–°–ê",
            'description': "–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç–µ 30-–º–∏–Ω—É—Ç–Ω—É—é —Å–µ—Å—Å–∏—é —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏, —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—è –∫–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è –Ω–µ–¥–µ–ª–∏ —Å –≤–∞—à–∏–º–∏ 10 —Ü–µ–Ω–Ω–æ—Å—Ç—è–º–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Ö–Ω–∏–∫—É ¬´—Ü–µ–Ω–Ω–æ—Å—Ç–Ω–æ–≥–æ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è¬ª: –ø—Ä–∏ —Å–ª–æ–∂–Ω–æ–º –≤—ã–±–æ—Ä–µ –æ—Ü–µ–Ω–∏–≤–∞–π—Ç–µ –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ —à–∫–∞–ª–µ –æ—Ç 1 –¥–æ 10 –ø–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—é –∫–∞–∂–¥–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏. –≠—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ —É–ª—É—á—à–∏—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–∏–π –Ω–∞ 47% (–ø–æ –¥–∞–Ω–Ω—ã–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –≤ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–π —ç–∫–æ–Ω–æ–º–∏–∫–µ), –Ω–æ –∏ —É–∫—Ä–µ–ø–∏—Ç –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–≤—è–∑–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ü–µ–Ω–Ω–æ—Å—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º, —Å–æ–∑–¥–∞–≤–∞—è ¬´–∞–≤—Ç–æ–ø–∏–ª–æ—Ç¬ª –¥–ª—è —ç—Ç–∏—á–Ω—ã—Ö –∏ –∞—É—Ç–µ–Ω—Ç–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.",
            'duration': "–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –ø–æ 30 –º–∏–Ω—É—Ç",
            'result': "–ß–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞ –≤—ã—Ä–∞–±–æ—Ç–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ü–µ–Ω–Ω–æ—Å—Ç–Ω–æ–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Ç—É–∞—Ü–∏–π"
        },
        {
            'title': "–†–ò–¢–£–ê–õ –ï–ñ–ï–î–ù–ï–í–ù–û–ì–û –í–´–†–ê–í–ù–ò–í–ê–ù–ò–Ø",
            'description': "–ö–∞–∂–¥–æ–µ —É—Ç—Ä–æ –≤—ã–¥–µ–ª—è–π—Ç–µ 7 –º–∏–Ω—É—Ç –Ω–∞ ¬´—Ü–µ–Ω–Ω–æ—Å—Ç–Ω–æ–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ¬ª: –≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ 10 —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π –∫–∞–∫ —Ñ–æ–∫—É—Å –¥–Ω—è –∏ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –æ–¥–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –µ–µ –ø—Ä–æ—è–≤–∏—Ç. –í–µ—á–µ—Ä–æ–º –ø–æ—Ç—Ä–∞—Ç—å—Ç–µ 3 –º–∏–Ω—É—Ç—ã –Ω–∞ –∞–Ω–∞–ª–∏–∑: –∫–∞–∫ —Ü–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ—è–≤–∏–ª–∞—Å—å, —á—Ç–æ —É–¥–∞–ª–æ—Å—å, –∫–∞–∫–∏–µ –∏–Ω—Å–∞–π—Ç—ã. –≠—Ç–æ—Ç —Ä–∏—Ç—É–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –º–∏–∫—Ä–æ–º–µ–¥–∏—Ç–∞—Ü–∏—è, –∞–∫—Ç–∏–≤–∏—Ä—É—é—â–∞—è –ø—Ä–µ—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—É—é –∫–æ—Ä—É (–æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä) –∏ —Å–Ω–∏–∂–∞—é—â–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–∏–Ω–¥–∞–ª–µ–≤–∏–¥–Ω–æ–≥–æ —Ç–µ–ª–∞ (–∏—Å—Ç–æ—á–Ω–∏–∫ –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã—Ö —Ä–µ–∞–∫—Ü–∏–π). –ù–µ–π—Ä–æ–±–∏–æ–ª–æ–≥–∏ –æ—Ç–º–µ—á–∞—é—Ç, —á—Ç–æ —Ç–∞–∫–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å –º–æ–∑–≥–æ–≤—ã—Ö –≤–æ–ª–Ω –Ω–∞ 32%.",
            'duration': "–ï–∂–µ–¥–Ω–µ–≤–Ω–æ 10 –º–∏–Ω—É—Ç (7 —É—Ç—Ä–æ–º + 3 –≤–µ—á–µ—Ä–æ–º)",
            'result': "–£—Å—Ç–æ–π—á–∏–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ flow –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ decision fatigue"
        },
        {
            'title': "–≠–ö–°–ü–ï–†–ò–ú–ï–ù–¢ –ü–û –£–°–ò–õ–ï–ù–ò–Æ –°–ê–ú–û–ô –°–õ–ê–ë–û–ô –¶–ï–ù–ù–û–°–¢–ò",
            'description': "–í—ã–±–µ—Ä–∏—Ç–µ —Ü–µ–Ω–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏ —Ä–µ–∂–µ –≤—Å–µ–≥–æ. –ù–∞ 30 –¥–Ω–µ–π —Å–æ–∑–¥–∞–π—Ç–µ ¬´—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—É—é –∑–æ–Ω—É¬ª: –∫–∞–∂–¥—ã–π –¥–µ–Ω—å —Å–æ–≤–µ—Ä—à–∞–π—Ç–µ –æ–¥–Ω–æ –º–∏–∫—Ä–æ-–¥–µ–π—Å—Ç–≤–∏–µ, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –Ω–∞ —ç—Ç—É —Ü–µ–Ω–Ω–æ—Å—Ç—å, –Ω–µ –æ–∂–∏–¥–∞—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –§–∏–∫—Å–∏—Ä—É–π—Ç–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∂—É—Ä–Ω–∞–ª–µ. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö acceptance and commitment therapy (ACT), –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–∞–∑–≤–∏—Ç—ã–µ –∞—Å–ø–µ–∫—Ç—ã –ª–∏—á–Ω–æ—Å—Ç–∏ –±–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è. –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ 30-–¥–Ω–µ–≤–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –º–µ–Ω—è—é—Ç self-perception –Ω–∞ 68% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ, —á–µ–º –ø–æ–ø—ã—Ç–∫–∏ ¬´—Å—Ç–∞—Ç—å –ª—É—á—à–µ¬ª.",
            'duration': "30 –¥–Ω–µ–π –ø–æ 5-15 –º–∏–Ω—É—Ç –≤ –¥–µ–Ω—å",
            'result': "–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ —Ä–µ–ø–µ—Ä—Ç—É–∞—Ä–∞ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ç–µ–Ω–µ–≤—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤"
        }
    ]
    
    for i, action in enumerate(actions, 1):
        analysis += f"\n<b>{i}. {action['title']}</b>\n"
        analysis += f"{action['description']}\n"
        analysis += f"<em>‚è±Ô∏è –í—Ä–µ–º—è:</em> {action['duration']}\n"
        analysis += f"<em>üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:</em> {action['result']}\n\n"
    
    # –ß–∞—Å—Ç—å 6: –ö–Ω–∏–≥–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è
    analysis += f"""
üìö <b>3 –ö–õ–Æ–ß–ï–í–´–ï –ö–ù–ò–ì–ò –î–õ–Ø –í–ê–®–ï–ì–û –†–ê–ó–í–ò–¢–ò–Ø:</b>

1. <b>¬´–°–ò–õ–ê –ù–ê–°–¢–û–Ø–©–ï–ì–û¬ª - –≠–∫—Ö–∞—Ä—Ç –¢–æ–ª–ª–µ</b>
   <em>–î–ª—è —á–µ–≥–æ:</em> –†–∞–∑–≤–∏—Ç–∏–µ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π –≤ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç
   <em>–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:</em> –¶–µ–Ω–Ω–æ—Å—Ç–∏ –∂–∏–≤—É—Ç —Ç–æ–ª—å–∫–æ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º - –ø—Ä–æ—à–ª–æ–µ –ø–∞–º—è—Ç—å, –±—É–¥—É—â–µ–µ –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏–µ
   <em>–ü—Ä–∞–∫—Ç–∏–∫–∞:</em> –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ 5-–º–∏–Ω—É—Ç–Ω—ã–µ –ø–∞—É–∑—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è

2. <b>¬´–ê–¢–û–ú–ù–´–ï –ü–†–ò–í–´–ß–ö–ò¬ª - –î–∂–µ–π–º—Å –ö–ª–∏—Ä</b>
   <em>–î–ª—è —á–µ–≥–æ:</em> –ü—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
   <em>–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:</em> 1% —É–ª—É—á—à–µ–Ω–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –¥–∞–µ—Ç 37-–∫—Ä–∞—Ç–Ω—ã–π —Ä–æ—Å—Ç –∑–∞ –≥–æ–¥
   <em>–ü—Ä–∞–∫—Ç–∏–∫–∞:</em> –°–∏—Å—Ç–µ–º–∞ habit stacking –¥–ª—è —Ü–µ–Ω–Ω–æ—Å—Ç–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

3. <b>¬´–î–†–ê–ô–í¬ª - –î—ç–Ω–∏–µ–ª –ü–∏–Ω–∫</b>
   <em>–î–ª—è —á–µ–≥–æ:</em> –ü–æ–Ω–∏–º–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ü–µ–Ω–Ω–æ—Å—Ç—è–º
   <em>–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:</em> –ê–≤—Ç–æ–Ω–æ–º–∏—è, –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ - –æ—Å–Ω–æ–≤–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –º–æ—Ç–∏–≤–∞—Ü–∏–∏
   <em>–ü—Ä–∞–∫—Ç–∏–∫–∞:</em> –°–æ–∑–¥–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏–π –¥–ª—è flow –≤ —Ü–µ–Ω–Ω–æ—Å—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
"""
    
    # –ß–∞—Å—Ç—å 7: –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
    analysis += f"""
üíé <b>–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï –ò –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò</b>

–í–∞—à–∏ 10 —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫, –∞ <b>–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç</b> –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –∂–∏–∑–Ω–∏. 
–ö–∞–∂–¥–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –¥—Ä—É–≥–∏–º–∏, —Å–æ–∑–¥–∞–≤–∞—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ª–∞–Ω–¥—à–∞—Ñ—Ç.

<b>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–π –º–µ—Å—è—Ü:</b>
1. –†–∞—Å–ø–µ—á–∞—Ç–∞–π—Ç–µ —ç—Ç–æ—Ç –∞–Ω–∞–ª–∏–∑ –∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç–µ –Ω–∞ –≤–∏–¥–Ω–æ–º –º–µ—Å—Ç–µ
2. –ù–∞—á–Ω–∏—Ç–µ —Å –æ–¥–Ω–æ–≥–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –≤ —ç—Ç–æ–º –Ω–µ–¥–µ–ª—é
3. –ó–∞–ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ –ø–æ–≤—Ç–æ—Ä —Ç–µ—Å—Ç–∞ —á–µ—Ä–µ–∑ 90 –¥–Ω–µ–π –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–∏–Ω–∞–º–∏–∫–∏
4. –ù–∞–π–¥–∏—Ç–µ 1-2 –µ–¥–∏–Ω–æ–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–≤ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Ü–µ–Ω–Ω–æ—Å—Ç–Ω—ã—Ö –∏–Ω—Å–∞–π—Ç–æ–≤

üåü <b>–ü–æ–º–Ω–∏—Ç–µ:</b> –¶–µ–Ω–Ω–æ—Å—Ç–∏ - —ç—Ç–æ –º—ã—à—Ü—ã –¥—É—à–∏. –†–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –∏—Ö –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è –¥–µ–ª–∞–µ—Ç –∂–∏–∑–Ω—å –Ω–µ –ø—Ä–æ—Å—Ç–æ —É—Å–ø–µ—à–Ω–æ–π, –Ω–æ –∏ –≥–ª—É–±–æ–∫–æ –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–π.

üîÑ <b>–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –¥–ª—è –¥—Ä—É–≥–æ–π —Å—Ñ–µ—Ä—ã –∂–∏–∑–Ω–∏:</b> üéÆ –ù–ê–ß–ê–¢–¨ –¢–ï–°–¢
"""
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∞–Ω–∞–ª–∏–∑ —á–∞—Å—Ç—è–º–∏ (–∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã –≤ Telegram)
    parts = []
    current_part = ""
    
    # –†–∞–∑–±–∏–≤–∞–µ–º –∞–Ω–∞–ª–∏–∑ –Ω–∞ —á–∞—Å—Ç–∏ –ø–æ 4000 —Å–∏–º–≤–æ–ª–æ–≤
    for paragraph in analysis.split("\n\n"):
        if len(current_part) + len(paragraph) + 2 < 4000:
            current_part += paragraph + "\n\n"
        else:
            parts.append(current_part)
            current_part = paragraph + "\n\n"
    
    if current_part:
        parts.append(current_part)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Å–µ —á–∞—Å—Ç–∏
    for i, part in enumerate(parts, 1):
        await message.answer(part, reply_markup=ReplyKeyboardRemove() if i == len(parts) else None)
        await asyncio.sleep(1)
    
    # –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
    final_msg = """
üéâ <b>–ê–ù–ê–õ–ò–ó –ü–û–õ–ù–û–°–¢–¨–Æ –°–§–û–†–ú–ò–†–û–í–ê–ù!</b>

–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ü–µ–Ω–Ω–æ—Å—Ç–Ω—ã–π –∫–æ–º–ø–∞—Å –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

üí° <b>–°–æ–≤–µ—Ç:</b> –í–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —ç—Ç–æ–º—É –∞–Ω–∞–ª–∏–∑—É –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –≤–∞–∂–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –∏–ª–∏ –æ—â—É—â–µ–Ω–∏–∏ –ø–æ—Ç–µ—Ä–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

üîÑ <b>–ù–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ—Å—Ç:</b> üéÆ –ù–ê–ß–ê–¢–¨ –¢–ï–°–¢
"""
    
    await message.answer(final_msg, reply_markup=get_main_keyboard())
    
    # –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    await state.clear()
    if user_id := message.from_user.id in active_games:
        del active_games[user_id]

# ========== –ó–ê–ü–£–°–ö ==========
async def main():
    logger.info("üöÄ –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –±–æ—Ç–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π...")
    
    if not BOT_TOKEN or BOT_TOKEN == "–í–ê–®_–¢–û–ö–ï–ù_–ë–û–¢–ê":
        logger.error("‚ùå –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ BOT_TOKEN!")
        input("–ù–∞–∂–º–∏—Ç–µ Enter...")
        return
    
    if not ALL_VALUES:
        logger.error("‚ùå –ù–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Ü–µ–Ω–Ω–æ—Å—Ç–∏!")
        input("–ù–∞–∂–º–∏—Ç–µ Enter...")
        return
    
    try:
        bot_info = await bot.get_me()
        logger.info(f"‚úÖ –ë–æ—Ç @{bot_info.username} –∑–∞–ø—É—â–µ–Ω!")
        logger.info(f"‚úÖ {len(ALL_VALUES)} —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π –¥–ª—è —Ç–µ—Å—Ç–∞")
        logger.info("‚úÖ –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞: 40√ó1 –∏–∑ 5 ‚Üí 10√ó1 –∏–∑ 4")
        logger.info("‚úÖ –ì–ª—É–±–æ–∫–∏–π –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑")
        logger.info("‚úÖ –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π: 1000+ —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é")
        logger.info("‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É üéÆ –ù–ê–ß–ê–¢–¨ –¢–ï–°–¢")
        
        await dp.start_polling(bot)
        
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞: {e}", exc_info=True)
        input("–ù–∞–∂–º–∏—Ç–µ Enter...")

if __name__ == "__main__":
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        print("\nüõë –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")